<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Refcard SQL</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Fabrice Niessen" />
<meta name="keywords" content="sql, emacs, yasnippet, snippets, code templates" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
</head>
<body>
<div id="content">
<h1 class="title">Refcard SQL</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org606fc8b">Help</a>
<ul>
<li><a href="#org51853dd">[d] Describe object</a></li>
<li><a href="#org3d43e83">[ld] List Databases</a></li>
<li><a href="#orgf375adf">[lf] List Functions</a></li>
<li><a href="#org0d84551">[li] List Indexes</a>
<ul>
<li><a href="#org4f821bb">List unused indexes</a></li>
</ul>
</li>
<li><a href="#org197c20c">[ll] List Logins</a></li>
<li><a href="#org2489a95">[ls] List Schemas</a></li>
<li><a href="#orgc15784b">[lt] List Tables</a></li>
<li><a href="#org5d64865">[lv] List Views</a></li>
<li><a href="#org7102492">[sf] Show Function</a></li>
</ul>
</li>
<li><a href="#org919e445">Sqsh</a></li>
<li><a href="#org206f21b">Mssql-cli</a>
<ul>
<li><a href="#org92c2a4b">Features</a></li>
<li><a href="#orga3196e8">Setup</a></li>
</ul>
</li>
<li><a href="#orgf63fc48">Emacs YASnippets</a>
<ul>
<li><a href="#org63d5fd5">Insert Snippet&#x2026;</a>
<ul>
<li><a href="#orgcf4946a">Cursor</a></li>
<li><a href="#org0647f6f">Database</a></li>
<li><a href="#org0831db2">Fragment</a></li>
<li><a href="#orga5d7745">Function</a></li>
<li><a href="#orgba283b6">Index</a></li>
<li><a href="#org0f1dd75">Join fragment</a></li>
<li><a href="#org727a865">Login</a></li>
<li><a href="#orgc1aad51">Role</a></li>
<li><a href="#org3497545">Schema</a></li>
<li><a href="#orgc9ec7e3">Set options</a></li>
<li><a href="#org2ca40fb">Stored Procedure</a></li>
<li><a href="#org32ee07a">Synonym</a></li>
<li><a href="#orgfb9a378">Table</a></li>
<li><a href="#org478fbb9">Transaction</a></li>
<li><a href="#org20f4fcb">Trigger</a></li>
<li><a href="#org82ddbd9">User</a></li>
<li><a href="#org057b111">User Defined Data Type</a></li>
<li><a href="#org5520b48">User Defined Table Type</a></li>
<li><a href="#org3091b07">User Defined Type</a></li>
<li><a href="#org8157604">View</a></li>
<li><a href="#org2426d0b">&#x2014; Miscellaneous ---</a></li>
</ul>
</li>
<li><a href="#org17644af">Surround With&#x2026;</a>
<ul>
<li><a href="#orgb3fe218">[begin] Code Snippet for BEGIN&#x2026;END block</a></li>
<li><a href="#org0b245ec">[if] Code Snippet for IF construct</a></li>
<li><a href="#orge142783">[while] Code Snippet for WHILE loop</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org606fc8b" class="outline-2">
<h2 id="org606fc8b">Help</h2>
<div class="outline-text-2" id="text-org606fc8b">
</div>
<div id="outline-container-org51853dd" class="outline-3">
<h3 id="org51853dd">[d] Describe object</h3>
<div class="outline-text-3" id="text-org51853dd">
<p>
List or describe database objects. Calls <code>sp_help</code>.
</p>

<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">EXEC</span> sp_help <span class="org-string">'${1:object}'</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-org3d43e83" class="outline-3">
<h3 id="org3d43e83">[ld] List Databases</h3>
<div class="outline-text-3" id="text-org3d43e83">
<p>
List databases.
</p>

<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>
    <span class="org-keyword">name</span>,
    create_date,
    compatibility_level,
    <span class="org-keyword">collation_name</span>
<span class="org-keyword">FROM</span> sys.databases
<span class="org-keyword">WHERE</span> <span class="org-keyword">name</span> <span class="org-keyword">LIKE</span> <span class="org-string">'%%'</span>;
</pre>
</div>

<p>
A <b>collation</b> consists of an enumeration of data and their equivalence to deduce
therefrom the processing behavior of the strings especially in the <b>comparison</b>
and <b>sorting</b> operations.
</p>

<ul class="org-ul">
<li><b>Code Page --</b> 1-4 digit number specifying code page.</li>
<li><b>Case Sensitivity --</b> CS = case sensitive, CI = insensitive.</li>
<li><b>Accent Sensitivity --</b> AI = accent insensitive, AS = accent sensitive.</li>
</ul>

<p>
Collation <code>SQL_Latin1_General_CP1_CI_AI</code>:
</p>

<ul class="org-ul">
<li>CP1 = Code Page 1252, that is Latin(ANSI).</li>
<li>Case-Insensitive.</li>
<li>Accent-Insensitive.</li>
</ul>
</div>
</div>

<div id="outline-container-orgf375adf" class="outline-3">
<h3 id="orgf375adf">[lf] List Functions</h3>
<div class="outline-text-3" id="text-orgf375adf">
<p>
List functions.
</p>
</div>
</div>

<div id="outline-container-org0d84551" class="outline-3">
<h3 id="org0d84551">[li] List Indexes</h3>
<div class="outline-text-3" id="text-org0d84551">
<p>
List indexes.
</p>

<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>
    t.<span class="org-keyword">name</span>                              <span class="org-keyword">AS</span> "TableName",
    i.<span class="org-keyword">name</span>                              <span class="org-keyword">AS</span> "IndexName",
    col.<span class="org-keyword">name</span>                            <span class="org-keyword">AS</span> "ColumnName",
    i.index_id                          <span class="org-keyword">AS</span> "IndexId",
    ic.index_column_id                  <span class="org-keyword">AS</span> "ColumnId"
<span class="org-keyword">FROM</span> sys.indexes                        i
<span class="org-keyword">INNER</span> <span class="org-keyword">JOIN</span> sys.index_columns            ic
    <span class="org-keyword">ON</span> i.<span class="org-builtin">object_id</span> = ic.<span class="org-builtin">object_id</span> <span class="org-keyword">AND</span> i.index_id = ic.index_id
<span class="org-keyword">INNER</span> <span class="org-keyword">JOIN</span> sys.columns                  col
    <span class="org-keyword">ON</span> ic.<span class="org-builtin">object_id</span> = col.<span class="org-builtin">object_id</span> <span class="org-keyword">AND</span> ic.column_id = col.column_id
<span class="org-keyword">INNER</span> <span class="org-keyword">JOIN</span> sys.tables                   t
    <span class="org-keyword">ON</span> i.<span class="org-builtin">object_id</span> = t.<span class="org-builtin">object_id</span>
<span class="org-keyword">WHERE</span> i.is_primary_key = 0
    <span class="org-keyword">AND</span> i.is_unique = 0
    <span class="org-keyword">AND</span> i.is_unique_constraint = 0
    <span class="org-keyword">AND</span> t.is_ms_shipped = 0
    <span class="org-keyword">AND</span> i.<span class="org-keyword">name</span> <span class="org-keyword">LIKE</span> <span class="org-string">'%%'</span>                <span class="org-comment">-- Index name.</span>
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span>
    t.<span class="org-keyword">name</span>,
    i.<span class="org-keyword">name</span>,
    i.index_id,
    ic.index_column_id;
</pre>
</div>

<p>
A <b>comma-separated list</b> of index columns could be an improvement&#x2026;
</p>
</div>

<div id="outline-container-org4f821bb" class="outline-4">
<h4 id="org4f821bb">List unused indexes</h4>
<div class="outline-text-4" id="text-org4f821bb">
<div class="org-src-container">
<pre class="src src-sql"><span class="org-doc">USE MASTER;</span>
<span class="org-doc">GO</span>
<span class="org-keyword">GRANT</span> <span class="org-keyword">VIEW</span> SERVER <span class="org-keyword">STATE</span> <span class="org-keyword">TO</span> afm;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span>
    <span class="org-builtin">OBJECT_NAME</span>(s.<span class="org-builtin">object_id</span>)            <span class="org-keyword">AS</span> "<span class="org-keyword">table_name</span>",
    i.<span class="org-keyword">name</span>                              <span class="org-keyword">AS</span> "index_name",
    i.index_id,
    user_seeks + user_scans + user_lookups <span class="org-keyword">AS</span> "<span class="org-keyword">reads</span>",
    user_updates                        <span class="org-keyword">AS</span> "writes",
    <span class="org-keyword">SUM</span>(p.<span class="org-keyword">rows</span>)                         <span class="org-keyword">AS</span> "<span class="org-keyword">rows</span>",
    last_user_update
<span class="org-keyword">FROM</span> sys.dm_db_index_usage_stats        s
<span class="org-keyword">JOIN</span> sys.indexes                        i
    <span class="org-keyword">ON</span> s.<span class="org-builtin">object_id</span> = i.<span class="org-builtin">object_id</span> <span class="org-keyword">AND</span> i.index_id = s.index_id
<span class="org-keyword">JOIN</span> sys.partitions                     p
    <span class="org-keyword">ON</span> s.<span class="org-builtin">object_id</span> = p.<span class="org-builtin">object_id</span> <span class="org-keyword">AND</span> p.index_id = s.index_id
<span class="org-keyword">WHERE</span> <span class="org-builtin">OBJECTPROPERTY</span>(s.<span class="org-builtin">object_id</span>, <span class="org-string">'IsUserTable'</span>) = 1
    <span class="org-keyword">AND</span> s.index_id &gt; 0
    <span class="org-keyword">AND</span> s.database_id = <span class="org-builtin">DB_ID</span>() <span class="org-comment">-- Database ID of the current database.</span>
    <span class="org-keyword">AND</span> user_seeks + user_scans + user_lookups = 0
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span>
    <span class="org-builtin">OBJECT_NAME</span>(s.<span class="org-builtin">object_id</span>),
    i.<span class="org-keyword">name</span>,
    i.index_id,
    user_seeks + user_scans + user_lookups,
    user_updates,
    last_user_update
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span>
    writes <span class="org-keyword">DESC</span>,
    <span class="org-keyword">reads</span> <span class="org-keyword">ASC</span>;
</pre>
</div>

<p>
If you see indexes where:
</p>

<ul class="org-ul">
<li>there are no seeks, scans or lookups, but</li>
<li>there are updates,</li>
</ul>

<p>
this means that SQL Server has not used the index to satisfy a query but still
needs to maintain the index.
</p>

<div class="tip">
<p>
Remember that the data from these DMVs is reset when SQL Server is restarted, so
make sure you have collected data for a long enough period of time to determine
which indexes may be good candidates to be dropped.
</p>

</div>
</div>
</div>
</div>

<div id="outline-container-org197c20c" class="outline-3">
<h3 id="org197c20c">[ll] List Logins</h3>
<div class="outline-text-3" id="text-org197c20c">
<p>
List logins and associated roles.
</p>
</div>
</div>

<div id="outline-container-org2489a95" class="outline-3">
<h3 id="org2489a95">[ls] List Schemas</h3>
<div class="outline-text-3" id="text-org2489a95">
<p>
List schemas.
</p>
</div>
</div>

<div id="outline-container-orgc15784b" class="outline-3">
<h3 id="orgc15784b">[lt] List Tables</h3>
<div class="outline-text-3" id="text-orgc15784b">
<p>
List tables.
</p>
</div>
</div>

<div id="outline-container-org5d64865" class="outline-3">
<h3 id="org5d64865">[lv] List Views</h3>
<div class="outline-text-3" id="text-org5d64865">
<p>
List views.
</p>
</div>
</div>

<div id="outline-container-org7102492" class="outline-3">
<h3 id="org7102492">[sf] Show Function</h3>
<div class="outline-text-3" id="text-org7102492">
<p>
Show a function&rsquo;s definition.
</p>
</div>
</div>
</div>

<div id="outline-container-org919e445" class="outline-2">
<h2 id="org919e445">Sqsh</h2>
<div class="outline-text-2" id="text-org919e445">
<div class="org-src-container">
<pre class="src src-conf"><span class="org-comment-delimiter"># </span><span class="org-comment">Hey Emacs, this is a -*- conf -*- file</span>
<span class="org-comment-delimiter">## </span><span class="org-comment">.sqshrc - My sqsh initialization file</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Copyright (C) 2013-&lt;&lt;current-year()&gt;&gt; Fabrice Niessen</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Author: Fabrice Niessen &lt;(concat "fni" at-symbol "pirilampo.org")&gt;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Keywords: sqsh, dotfile, config</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">* Connections</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Setting your password within your `.sqshrc' is probably the most secure method</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">of using sqsh.  However, make sure that you `chmod go-rwx ~/.sqshrc',</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">otherwise you leave yourself wide open to attacks.</span>

<span class="org-variable-name">\set username</span>=<span class="org-string">"sa"</span>
<span class="org-variable-name">\set password</span>=<span class="org-string">"mysecret"</span>
<span class="org-variable-name">\set hostname</span>=<span class="org-string">"localhost"</span>
<span class="org-variable-name">\set database</span>=[ARCHIBUS_23_2_HQ]

<span class="org-comment-delimiter">#</span><span class="org-comment">* Aliasing</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">** Display styles</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">\set colsep='| '</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Currently supported styles are:</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">- horiz (or hor or horizontal) (*) = default</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">- vert (or vertical) (*),</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">- bcp,</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">- csv,</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">- html,</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">- meta,</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">- pretty (*), and</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">- none.</span>

<span class="org-variable-name">\alias goh</span>=<span class="org-string">'\go -m horiz | ${PAGER}'</span>

<span class="org-variable-name">\alias gov</span>=<span class="org-string">'\go -m vert | ${PAGER}'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">*Very* useful for doing quick bcp commands from command line, and using</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">re-direction directly to a file!</span>
<span class="org-variable-name">\alias gob</span>=<span class="org-string">'\go -m bcp | ${PAGER}'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Firefox.</span>
<span class="org-variable-name">\alias gof</span>=<span class="org-string">'\go -m html | (cat &gt; /tmp/sqsh-output.html; /mnt/c/Windows/explorer.exe file:///tmp/sqsh-output.html)'</span>

<span class="org-variable-name">\alias gom</span>=<span class="org-string">'\go -m meta | ${PAGER}'</span>

<span class="org-variable-name">\alias gop</span>=<span class="org-string">'\go -m pretty -w80 | ${PAGER}'</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">** Aliases for T-SQL commands</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-conf"><span class="org-variable-name">\alias statson</span>=<span class="org-string">'\loop -e "SET STATISTICS IO ON; SET STATISTICS TIME ON;"'</span>
<span class="org-variable-name">\alias statsoff</span>=<span class="org-string">'\loop -e "SET STATISTICS IO OFF; SET STATISTICS TIME OFF;"'</span>
</pre>
</div>

<p>
SQL Server Execution Time: This refers to the time taken by SQL server to
complete the execution of the compiled plan.
</p>

<p>
<b>CPU time</b> refers to the actual time spent on CPU.
</p>

<p>
The <b>elapsed time</b> is the total time to complete the execution which includes
signal wait time, wait time to complete the IO operation and time taken to
transfer the output to the client.
</p>

<p>
<b>CPU time</b> is really where you want to pay attention for <b>performance tuning</b>, as it
can be
</p>
<ul class="org-ul">
<li>higher than the <b>elapsed time</b> if the query goes parallel, or</li>
<li>lower if the procedure spends time sleeping on wait signals and I/O
operations.</li>
</ul>

<p>
The <b>CPU time</b> can be used to baseline the performance tuning. This value will not
vary much from execution to execution unless you modify the query or data. The
load on the server will not impact much on this value.
</p>

<p>
The <b>elapsed time</b> will depend on many factors, like load on the server, IO load,
network bandwidth between server and client.
</p>

<p>
So always use the CPU time as baseline while doing the performance tuning.
</p>

<p>
Want to <b>format your output</b> online in a web browser?  The <a href="http://statisticsparser.com/index.html">Statistics Parser</a> will
help with that. Just paste in the output of Statistics IO and/or Statistics Time
and press Parse. Your output will be formatted and totaled. Enjoy.
</p>

<div class="org-src-container">
<pre class="src src-conf"><span class="org-variable-name">\alias planon</span>=<span class="org-string">'\loop -e "SET SHOWPLAN ON"'</span>
<span class="org-variable-name">\alias planoff</span>=<span class="org-string">'\loop -e "SET SHOWPLAN OFF"'</span>

<span class="org-variable-name">\alias ton</span>=<span class="org-string">'\loop -e "DBCC TRACEON(3604)"'</span>
<span class="org-variable-name">\alias toff</span>=<span class="org-string">'\loop -e "DBCC TRACEOFF(3604)"'</span>

<span class="org-variable-name">\alias tempdb</span>=<span class="org-string">'\loop -e "USE tempdb"'</span>
<span class="org-variable-name">\alias master</span>=<span class="org-string">'\loop -e "USE master"'</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">** Aliases for sqsh commands</span>

<span class="org-variable-name">\alias DEV</span>=<span class="org-string">'\reconnect -SDEV -Usa -Pmysecret'</span>
<span class="org-variable-name">\alias STG</span>=<span class="org-string">'\reconnect -SSTG -Usa -Pmysecret'</span>
<span class="org-variable-name">\alias PRD</span>=<span class="org-string">'\reconnect -c -SPRD -Usa -Pmysecret'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Clear screen within sqsh session.</span>
<span class="org-variable-name">\alias clear</span>=<span class="org-string">"\shell clear"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Read a file into sqsh session.</span>
<span class="org-variable-name">\alias :r</span>=<span class="org-string">'\buf-load -a !*'</span>
<span class="org-variable-name">\alias r</span>=<span class="org-string">"\buf-load "</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Drop you into a shell out of sqsh.</span>
<span class="org-variable-name">\alias sh</span>=<span class="org-string">"\shell "</span>

<span class="org-variable-name">\alias h</span>=<span class="org-string">"\history"</span>

<span class="org-variable-name">\alias xx</span>=<span class="org-string">'\reset'</span>

<span class="org-variable-name">\alias q</span>=<span class="org-string">"\exit"</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">* Miscellaneous</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Turn off the sqsh banner; cosmetic only</span>
<span class="org-variable-name">\set banner</span>=no

<span class="org-variable-name">\set width</span>=65535

<span class="org-comment-delimiter"># </span><span class="org-comment">Have semicolons executing commands (sort of inline "go")...</span>
<span class="org-variable-name">\set semicolon_hack</span>=on

<span class="org-comment-delimiter"># </span><span class="org-comment">Turn on ability to have !-recall commands.</span>
<span class="org-variable-name">\set history_shorthand</span>=on

<span class="org-comment-delimiter"># </span><span class="org-comment">This variable causes sqsh to exit with an exit status of the total number of</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">batches that failed during the current session.  This is useful for use within</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">shell scripts and the such.</span>
<span class="org-variable-name">\set exit_failcount</span>=on

<span class="org-variable-name">\set prompt_color</span>=<span class="org-string">'{0;34;47}'</span>
<span class="org-variable-name">\set text_color</span>=<span class="org-string">'{0;33}'</span>
<span class="org-variable-name">\set prompt</span>=<span class="org-string">'$prompt_color{{$username@$DSQUERY:$database}}&gt;$text_color '</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">This is for the sake of Emacs.</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Local Variables&#58;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">mode: outline-minor</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">End:</span>

<span class="org-comment-delimiter">## </span><span class="org-comment">.sqshrc ends here</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org206f21b" class="outline-2">
<h2 id="org206f21b">Mssql-cli</h2>
<div class="outline-text-2" id="text-org206f21b">
</div>
<div id="outline-container-org92c2a4b" class="outline-3">
<h3 id="org92c2a4b">Features</h3>
<div class="outline-text-3" id="text-org92c2a4b">
<p>
New and interactive command line query tool for SQL Server. This open source
tool works cross-platform and is a proud member of the dbcli community.
</p>

<p>
Features
</p>
<ul class="org-ul">
<li>Mssql-cli auto-completion that is context aware</li>
<li>T-SQL IntelliSense</li>
<li>Syntax highlighting</li>
<li>Pretty formatting for query results, including Vertical Format</li>
<li>Multi-line edit mode</li>
<li>Configuration file support</li>
</ul>

<p>
<a href="https://cloudblogs.microsoft.com/sqlserver/2017/12/12/try-mssql-cli-a-new-interactive-command-line-tool-for-sql-server/">https://cloudblogs.microsoft.com/sqlserver/2017/12/12/try-mssql-cli-a-new-interactive-command-line-tool-for-sql-server/</a>
</p>
</div>
</div>

<div id="outline-container-orga3196e8" class="outline-3">
<h3 id="orga3196e8">Setup</h3>
<div class="outline-text-3" id="text-orga3196e8">
<div class="org-src-container">
<pre class="src src-shell">sudo apt install python-pip python-dev
sudo pip install --upgrade pip
sudo pip install mssql-cli
</pre>
</div>

<div class="org-src-container">
<pre class="src src-shell">mssql-cli -E
kinit.exe user@domain.com
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf63fc48" class="outline-2">
<h2 id="orgf63fc48">Emacs YASnippets</h2>
<div class="outline-text-2" id="text-orgf63fc48">
<p>
A <b>SQL snippet</b> is a frequently used <b>code template</b> which can be inserted into
a code you are typing by pressing the TAB key.
</p>

<p>
Snippets are categorized into 2 types:
</p>

<ul class="org-ul">
<li><b>Insert Snippets (or Expansion Snippets)</b>: These are code templates for various
SQL commands you can quickly insert into your SQL code when creating tables,
stored procedures, triggers and so on.</li>

<li><b>Surround Snippets:</b> These are code templates that help you implement code
constructs such as <code>BEGIN...END</code>, <code>IF</code>, <code>WHILE</code> and so on.</li>
</ul>
</div>

<div id="outline-container-org63d5fd5" class="outline-3">
<h3 id="org63d5fd5">Insert Snippet&#x2026;</h3>
<div class="outline-text-3" id="text-org63d5fd5">
</div>
<div id="outline-container-orgcf4946a" class="outline-4">
<h4 id="orgcf4946a">Cursor</h4>
<div class="outline-text-4" id="text-orgcf4946a">
</div>
<div id="outline-container-org49435f0" class="outline-5">
<h5 id="org49435f0">[curff] Cursor Fast-Forward</h5>
<div class="outline-text-5" id="text-org49435f0">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: Fast-forward <span class="org-keyword">read</span>-<span class="org-keyword">on</span>...
# <span class="org-comment">--</span>
<span class="org-comment-delimiter">/* </span><span class="org-comment">declare variables */</span>
<span class="org-keyword">DECLARE</span> <span class="org-variable-name">@variable</span> <span class="org-type">INT</span>

<span class="org-keyword">DECLARE</span> ${1:<span class="org-keyword">cursor_name</span>} <span class="org-type">CURSOR</span>
FAST_FORWARD READ_ONLY
<span class="org-keyword">FOR</span> ${2:select_statement}

<span class="org-keyword">OPEN</span> $1

<span class="org-keyword">FETCH</span> <span class="org-keyword">NEXT</span> <span class="org-keyword">FROM</span> $1
<span class="org-keyword">INTO</span> <span class="org-variable-name">@variable</span>

<span class="org-keyword">WHILE</span> <span class="org-builtin">@@FETCH_STATUS</span> = 0
<span class="org-keyword">BEGIN</span>
    $0

    <span class="org-keyword">FETCH</span> <span class="org-keyword">NEXT</span> <span class="org-keyword">FROM</span> $1
    <span class="org-keyword">INTO</span> <span class="org-variable-name">@variable</span>
<span class="org-keyword">END</span>

<span class="org-keyword">CLOSE</span> $1
<span class="org-keyword">DEALLOCATE</span> $1
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0647f6f" class="outline-4">
<h4 id="org0647f6f">Database</h4>
<div class="outline-text-4" id="text-org0647f6f">
</div>
<div id="outline-container-org7db4949" class="outline-5">
<h5 id="org7db4949">[cdb] Create DataBase</h5>
<div class="outline-text-5" id="text-org7db4949">
<p>
Create database.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Create</span> <span class="org-keyword">database</span>
# <span class="org-comment">--</span>
<span class="org-doc">USE master</span>
<span class="org-doc">go</span>

<span class="org-comment">-- Drop the database if it already exists</span>
<span class="org-keyword">IF</span> <span class="org-keyword">EXISTS</span> (<span class="org-keyword">SELECT</span> <span class="org-keyword">name</span>
        <span class="org-keyword">FROM</span> sys.databases
        <span class="org-keyword">WHERE</span> <span class="org-keyword">name</span> = N<span class="org-string">'${1:database_name}'</span>)
    <span class="org-keyword">DROP</span> <span class="org-keyword">DATABASE</span> $1
<span class="org-doc">go</span>

<span class="org-keyword">CREATE</span> <span class="org-keyword">DATABASE</span> $1
<span class="org-keyword">ON</span>
<span class="org-keyword">PRIMARY</span> ( <span class="org-comment">-- or use FILEGROUP filegroup_name</span>
  <span class="org-keyword">NAME</span> = $1_data,
  FILENAME = <span class="org-string">'$1.mdf'</span>
) <span class="org-comment">--, and repeat as required</span>
<span class="org-builtin">LOG</span> <span class="org-keyword">ON</span>
(
  <span class="org-keyword">NAME</span> = $1_log,
  FILENAME = <span class="org-string">'$1.ldf'</span>
) <span class="org-comment">--, and repeat as required</span>
<span class="org-comment">--COLLATE collation_name</span>
<span class="org-comment">--WITH</span>
<span class="org-comment">--  DB_CHAINING ON/OFF</span>
<span class="org-comment">--  TRUSTWORTHY ON/OFF</span>
<span class="org-comment">--FOR LOAD</span>
<span class="org-comment">--FOR ATTACH</span>
<span class="org-comment">--WITH</span>
<span class="org-comment">--  ENABLE_BROKER</span>
<span class="org-comment">--  NEW_BROKER</span>
<span class="org-comment">--  ERROR_BROKER_CONVERSATIONS</span>
<span class="org-comment">--FOR ATTACH_REBUILD_LOG</span>
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga8638db" class="outline-5">
<h5 id="orga8638db">[cdbsnap] Create DataBase Snapshot</h5>
<div class="outline-text-5" id="text-orga8638db">
<p>
Create snapshot.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Create</span> <span class="org-keyword">database</span> sna...
# <span class="org-comment">--</span>
<span class="org-doc">USE master</span>
<span class="org-doc">go</span>

<span class="org-comment">-- Drop snapshot database if it already exists</span>
<span class="org-keyword">IF</span> <span class="org-keyword">EXISTS</span> (<span class="org-keyword">SELECT</span> <span class="org-keyword">name</span>
        <span class="org-keyword">FROM</span> sys.databases
        <span class="org-keyword">WHERE</span> <span class="org-keyword">name</span> = N<span class="org-string">'${1:source_database}_${2:snapshot_id}'</span>)
    <span class="org-keyword">DROP</span> <span class="org-keyword">DATABASE</span> $1_$2
<span class="org-doc">go</span>

<span class="org-comment">-- Create the snapshot database</span>
<span class="org-keyword">CREATE</span> <span class="org-keyword">DATABASE</span> $1_$2 <span class="org-keyword">ON</span>
( <span class="org-keyword">NAME</span> = $1_$2_data,
  FILENAME = <span class="org-string">'$1_$2.ss'</span>)
<span class="org-keyword">AS</span> SNAPSHOT <span class="org-keyword">OF</span> $1;
<span class="org-doc">go$0</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8b3d489" class="outline-5">
<h5 id="org8b3d489">[dd] Drop Database</h5>
<div class="outline-text-5" id="text-org8b3d489">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Drop</span> <span class="org-keyword">database</span>
# <span class="org-comment">--</span>
<span class="org-doc">USE master</span>
<span class="org-doc">go</span>

<span class="org-comment">-- Drop the database if it already exists</span>
<span class="org-keyword">IF</span> <span class="org-keyword">EXISTS</span> (<span class="org-keyword">SELECT</span> <span class="org-keyword">name</span>
        <span class="org-keyword">FROM</span> sys.databases
        <span class="org-keyword">WHERE</span> <span class="org-keyword">name</span> = N<span class="org-string">'${1:database_name}'</span>)
    <span class="org-keyword">DROP</span> <span class="org-keyword">DATABASE</span> $1
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga2e0534" class="outline-5">
<h5 id="orga2e0534">Database Backup</h5>
<div class="outline-text-5" id="text-orga2e0534">
<p>
Backup database.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Backup</span> <span class="org-keyword">database</span>
# <span class="org-comment">--</span>
<span class="org-keyword">BACKUP</span> <span class="org-keyword">DATABASE</span> ${1:database_name}
    <span class="org-keyword">TO</span> <span class="org-keyword">DISK</span> = N<span class="org-string">'Backup_Path/$1.bak'</span>
<span class="org-keyword">WITH</span>
    NOFORMAT,
    NOINIT,
    <span class="org-keyword">NAME</span> = N<span class="org-string">'$1-Full Database Backup'</span>,
    SKIP,
    STATS = 10;
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6650415" class="outline-5">
<h5 id="org6650415">Database Restore</h5>
<div class="outline-text-5" id="text-org6650415">
<p>
Restore database.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Restore</span> <span class="org-keyword">database</span>
# <span class="org-comment">--</span>
<span class="org-doc">USE master</span>
<span class="org-doc">go</span>

<span class="org-keyword">RESTORE</span> <span class="org-keyword">DATABASE</span> ${1:database_name}
    <span class="org-keyword">FROM</span> <span class="org-keyword">DISK</span> = N<span class="org-string">'Backup_Path/$1.bak'</span>
<span class="org-keyword">WITH</span>
    <span class="org-keyword">FILE</span> = 1,
    NOUNLOAD,
    <span class="org-builtin">REPLACE</span>,
    STATS = 10
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0831db2" class="outline-4">
<h4 id="org0831db2">Fragment</h4>
<div class="outline-text-4" id="text-org0831db2">
</div>
<div id="outline-container-org0a04883" class="outline-5">
<h5 id="org0a04883">[ii] Insert Into</h5>
<div class="outline-text-5" id="text-org0a04883">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">INSERT</span> <span class="org-keyword">INTO</span> fragment
# <span class="org-comment">--</span>
<span class="org-keyword">INSERT</span> <span class="org-keyword">INTO</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb935e90" class="outline-5">
<h5 id="orgb935e90">[ssf] Select Star From</h5>
<div class="outline-text-5" id="text-orgb935e90">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">SELECT</span> * <span class="org-keyword">FROM</span> frag...
# <span class="org-comment">--</span>
<span class="org-keyword">SELECT</span> * <span class="org-keyword">FROM</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-org7b3b6d3" class="outline-5">
<h5 id="org7b3b6d3">[st100] Select Top 100</h5>
<div class="outline-text-5" id="text-org7b3b6d3">
<p>
Select top 100 rows.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">SELECT</span> <span class="org-keyword">top</span> 100 <span class="org-keyword">rows</span>
# <span class="org-comment">--</span>
<span class="org-keyword">SELECT</span> <span class="org-keyword">TOP</span> 100 *
<span class="org-keyword">FROM</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-org4b575fb" class="outline-5">
<h5 id="org4b575fb">[scf] Select Count From</h5>
<div class="outline-text-5" id="text-org4b575fb">
<p>
Count number of records returned by query.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Count</span> <span class="org-keyword">number</span> <span class="org-keyword">of</span> rec...
# <span class="org-comment">--</span>
<span class="org-keyword">SELECT</span> <span class="org-keyword">COUNT</span>(*) <span class="org-keyword">FROM</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-org160bf1e" class="outline-5">
<h5 id="org160bf1e">[is] INFORMATION_SCHEMA</h5>
<div class="outline-text-5" id="text-org160bf1e">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: INFORMATION_SCH...
# <span class="org-comment">--</span>
INFORMATION_SCHEMA$0
</pre>
</div>
</div>
</div>

<div id="outline-container-org949497a" class="outline-5">
<h5 id="org949497a">[gb] Group By</h5>
<div class="outline-text-5" id="text-org949497a">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> fragment
# <span class="org-comment">--</span>
<span class="org-keyword">GROUP</span> <span class="org-keyword">BY</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-org78c0183" class="outline-5">
<h5 id="org78c0183">[ob] Order By</h5>
<div class="outline-text-5" id="text-org78c0183">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> fragment
# <span class="org-comment">--</span>
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-org286f9a3" class="outline-5">
<h5 id="org286f9a3">[df] Delete From</h5>
<div class="outline-text-5" id="text-org286f9a3">
<p>
Delete statement.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">DELETE</span> <span class="org-keyword">FROM</span> frag...
# <span class="org-comment">--</span>
<span class="org-keyword">DELETE</span> <span class="org-keyword">FROM</span> ${1:[<span class="org-keyword">schema</span>].[<span class="org-keyword">table_name</span>]}
<span class="org-keyword">WHERE</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-org3b2cb5c" class="outline-5">
<h5 id="org3b2cb5c">[be] Begin&#x2026;End</h5>
<div class="outline-text-5" id="text-org3b2cb5c">
<p>
Insert <code>BEGIN...END</code> block.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">BEGIN</span>...<span class="org-keyword">END</span> block
# <span class="org-comment">--</span>
<span class="org-keyword">BEGIN</span>
    $0
<span class="org-keyword">END</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org77b9233" class="outline-5">
<h5 id="org77b9233">[tc] Try &#x2026; Catch</h5>
<div class="outline-text-5" id="text-org77b9233">
<p>
Insert <code>TRY...CATCH</code> block.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: TRY ... CATCH fragm...
# <span class="org-comment">--</span>
<span class="org-keyword">BEGIN</span> TRY
    $0
<span class="org-keyword">END</span> TRY
<span class="org-keyword">BEGIN</span> CATCH
    <span class="org-comment-delimiter">/*</span>
<span class="org-comment">        SELECT</span>
<span class="org-comment">            ERROR_NUMBER() AS ErrorNumber,</span>
<span class="org-comment">            ERROR_SEVERITY() AS ErrorSeverity,</span>
<span class="org-comment">            ERROR_STATE() AS ErrorState,</span>
<span class="org-comment">            ERROR_PROCEDURE() AS ErrorProcedure,</span>
<span class="org-comment">            ERROR_LINE() AS ErrorLine,</span>
<span class="org-comment">            ERROR_MESSAGE() AS ErrorMessage</span>
<span class="org-comment">    */</span>
<span class="org-keyword">END</span> CATCH;
</pre>
</div>
</div>
</div>

<div id="outline-container-org622ed27" class="outline-5">
<h5 id="org622ed27">[ifs] If</h5>
<div class="outline-text-5" id="text-org622ed27">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">IF</span> fragment
# <span class="org-comment">--</span>
<span class="org-keyword">IF</span> 1 = 1
<span class="org-keyword">BEGIN</span>
    $0
<span class="org-keyword">END</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0fc5567" class="outline-5">
<h5 id="org0fc5567">If Exists</h5>
<div class="outline-text-5" id="text-org0fc5567">
<p>
Perform an operation if a selected object exists.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: ...
# <span class="org-comment">--</span>
<span class="org-keyword">IF</span> <span class="org-keyword">EXISTS</span>(
 <span class="org-keyword">SELECT</span>
 <span class="org-keyword">FROM</span> ${1:<span class="org-type">object</span>})
 <span class="org-keyword">BEGIN</span>
    $0
 <span class="org-keyword">END</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3454b5e" class="outline-5">
<h5 id="org3454b5e">Case</h5>
<div class="outline-text-5" id="text-org3454b5e">
<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">CASE</span> <span class="org-comment-delimiter">/*</span><span class="org-comment">expression*/</span>
    <span class="org-keyword">WHEN</span> <span class="org-comment-delimiter">/*</span><span class="org-comment">expression*/</span> <span class="org-keyword">THEN</span> <span class="org-comment-delimiter">/*</span><span class="org-comment">result_expression*/</span>
    <span class="org-keyword">WHEN</span> <span class="org-comment-delimiter">/*</span><span class="org-comment">expression*/</span> <span class="org-keyword">THEN</span> <span class="org-comment-delimiter">/*</span><span class="org-comment">result_expression*/</span>
    <span class="org-keyword">ELSE</span> <span class="org-comment-delimiter">/*</span><span class="org-comment">result_expression*/</span>
<span class="org-keyword">END</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9d99c66" class="outline-5">
<h5 id="org9d99c66">[cte] Common Table Expression</h5>
<div class="outline-text-5" id="text-org9d99c66">
<p>
Temporary inline view.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">WITH</span> cte fragment
# <span class="org-comment">--</span>
<span class="org-keyword">WITH</span> ${1:cte_name} <span class="org-keyword">AS</span>
(
    <span class="org-comment">-- SELECT</span>
    <span class="org-comment">-- FROM</span>
    <span class="org-comment">-- GROUP BY</span>
)
<span class="org-comment">-- Statement that executes the common table expression</span>
<span class="org-keyword">SELECT</span> $0
<span class="org-keyword">FROM</span> $1;
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orga5d7745" class="outline-4">
<h4 id="orga5d7745">Function</h4>
<div class="outline-text-4" id="text-orga5d7745">
<p>
Naming convention: functions are prefixed with <code>ufn</code>.
</p>
</div>

<div id="outline-container-orgd1033a6" class="outline-5">
<h5 id="orgd1033a6">[ctif] Create Inline Table Function</h5>
<div class="outline-text-5" id="text-orgd1033a6">
<p>
Creates an inline table function.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Create</span> inline <span class="org-keyword">table</span>-va...
# <span class="org-comment">--</span>
<span class="org-keyword">IF</span> <span class="org-builtin">OBJECT_ID</span> (N<span class="org-string">'${1:[schema].[inline_function_name]}'</span>, N<span class="org-string">'IF'</span>) <span class="org-keyword">IS</span> <span class="org-keyword">NOT</span> <span class="org-keyword">NULL</span>
    <span class="org-keyword">DROP</span> <span class="org-keyword">FUNCTION</span> $1;
<span class="org-doc">go</span>

<span class="org-comment">-- ================================================</span>
<span class="org-doc">SET ANSI_NULLS ON</span>
<span class="org-doc">go</span>
<span class="org-doc">SET QUOTED_IDENTIFIER ON</span>
<span class="org-doc">go</span>
<span class="org-comment">-- =============================================</span>
<span class="org-comment">-- Author:      /* Author */</span>
<span class="org-comment">-- Create date: /* Create Date */</span>
<span class="org-comment">-- Description: /* Description */</span>
<span class="org-comment">-- =============================================</span>
<span class="org-keyword">CREATE</span> <span class="org-keyword">FUNCTION</span> $1 (<span class="org-variable-name">@</span>${2:<span class="org-keyword">parameter_name</span>} ${3:parameter_data_type})
<span class="org-keyword">RETURNS</span> <span class="org-keyword">TABLE</span>
<span class="org-comment">--WITH ENCRYPTION|SCHEMABINDING, ...</span>
<span class="org-keyword">AS</span>
<span class="org-keyword">RETURN</span>
(
    <span class="org-comment">-- Add the SELECT statement with parameter references here</span>
    <span class="org-keyword">SELECT</span> <span class="org-variable-name">@</span>$2 <span class="org-keyword">AS</span> c1
    $0
);
<span class="org-doc">go</span>

<span class="org-comment">-- =============================================</span>
<span class="org-comment">-- Example to execute function</span>
<span class="org-comment">-- =============================================</span>
<span class="org-keyword">SELECT</span> *
<span class="org-keyword">FROM</span> $1 <span class="org-comment-delimiter">/* </span><span class="org-comment">owner.inline_function_name */</span>
    (<span class="org-comment-delimiter">/* </span><span class="org-comment">value_for_@parameter_name */</span>)
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orged86313" class="outline-5">
<h5 id="orged86313">[ctf] Create Multi-Statement Table Function</h5>
<div class="outline-text-5" id="text-orged86313">
<p>
Creates a multi-statement table function.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Create</span> multi-stateme...
# <span class="org-comment">--</span>
<span class="org-keyword">IF</span> <span class="org-builtin">OBJECT_ID</span> (N<span class="org-string">'${1:[schema].[table_function_name]}'</span>, N<span class="org-string">'TF'</span>) <span class="org-keyword">IS</span> <span class="org-keyword">NOT</span> <span class="org-keyword">NULL</span>
    <span class="org-keyword">DROP</span> <span class="org-keyword">FUNCTION</span> $1;
<span class="org-doc">go</span>

<span class="org-keyword">CREATE</span> <span class="org-keyword">FUNCTION</span> $1 (<span class="org-variable-name">@</span>{2:<span class="org-keyword">parameter_name</span>} ${3:parameter_data_type})
<span class="org-keyword">RETURNS</span> <span class="org-variable-name">@</span>${4:return_variable_name} <span class="org-keyword">TABLE</span>
(
    <span class="org-comment-delimiter">/* </span><span class="org-comment">table type definition */</span>
    $2 $3
)
<span class="org-comment">--WITH ENCRYPTION|SCHEMABINDING, ...</span>
<span class="org-keyword">AS</span>
<span class="org-keyword">BEGIN</span>
    <span class="org-comment-delimiter">/* </span><span class="org-comment">function body */</span>
    <span class="org-keyword">INSERT</span> <span class="org-variable-name">@</span>$4
    <span class="org-keyword">SELECT</span> 1
    <span class="org-keyword">RETURN</span>
<span class="org-keyword">END</span>;
<span class="org-doc">go</span>

<span class="org-comment">-- =============================================</span>
<span class="org-comment">-- Example to execute function</span>
<span class="org-comment">-- =============================================</span>
<span class="org-keyword">SELECT</span> * <span class="org-keyword">FROM</span> $1 <span class="org-comment-delimiter">/* </span><span class="org-comment">owner.table_function_name */</span>
    (<span class="org-comment-delimiter">/* </span><span class="org-comment">value_for_@parameter_name */</span>)
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org430afa9" class="outline-5">
<h5 id="org430afa9">[csf] Create Scalar Function</h5>
<div class="outline-text-5" id="text-org430afa9">
<p>
Creates a scalar function.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Create</span> scalar <span class="org-keyword">function</span>
# <span class="org-comment">--</span>
<span class="org-keyword">IF</span> <span class="org-builtin">OBJECT_ID</span> (N<span class="org-string">'${1:[schema].[scalar_function_name]}'</span>, N<span class="org-string">'FN'</span>) <span class="org-keyword">IS</span> <span class="org-keyword">NOT</span> <span class="org-keyword">NULL</span>
    <span class="org-keyword">DROP</span> <span class="org-keyword">FUNCTION</span> $1;
<span class="org-doc">go</span>

<span class="org-comment">-- =============================================</span>
<span class="org-doc">SET ANSI_NULLS ON</span>
<span class="org-doc">go</span>
<span class="org-doc">SET QUOTED_IDENTIFIER ON</span>
<span class="org-doc">go</span>
<span class="org-comment">-- =============================================</span>
<span class="org-comment">-- Author:      /* Author */</span>
<span class="org-comment">-- Create date: /* Create Date */</span>
<span class="org-comment">-- Description: /* Description */</span>
<span class="org-comment">-- =============================================</span>
<span class="org-keyword">CREATE</span> <span class="org-keyword">FUNCTION</span> $1 (<span class="org-variable-name">@</span>{2:<span class="org-keyword">parameter_name</span>} ${3:parameter_data_type})
<span class="org-keyword">RETURNS</span> ${4:function_data_type}
<span class="org-comment">--WITH ENCRYPTION|SCHEMABINDING, ...</span>
<span class="org-keyword">AS</span>
<span class="org-comment">-- Returns ...</span>
<span class="org-keyword">BEGIN</span>
    <span class="org-comment-delimiter">/* </span><span class="org-comment">function body */</span>
<span class="org-comment">--  eg.</span>
<span class="org-comment">--  DECLARE @v_ret $4</span>
<span class="org-comment">--  SELECT @v_ret = /* scalar expression */</span>
<span class="org-comment">--  RETURN @v_ret$0</span>
<span class="org-keyword">END</span>;
<span class="org-doc">go</span>

<span class="org-comment">-- =============================================</span>
<span class="org-comment">-- Example to execute function</span>
<span class="org-comment">-- =============================================</span>
<span class="org-keyword">SELECT</span> $1 <span class="org-comment-delimiter">/* </span><span class="org-comment">owner.scalar_function_name */</span>
    (<span class="org-comment-delimiter">/* </span><span class="org-comment">value_for_@parameter_name */</span>)
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7e316c0" class="outline-5">
<h5 id="org7e316c0">[af] Alter Function</h5>
<div class="outline-text-5" id="text-org7e316c0">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">ALTER</span> <span class="org-keyword">FUNCTION</span> fr...
# <span class="org-comment">--</span>
<span class="org-keyword">ALTER</span> <span class="org-keyword">FUNCTION</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-org5374eb4" class="outline-5">
<h5 id="org5374eb4">[dfn] Drop Function</h5>
<div class="outline-text-5" id="text-org5374eb4">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Drop</span> <span class="org-keyword">function</span>
# <span class="org-comment">--</span>
<span class="org-keyword">DROP</span> <span class="org-keyword">FUNCTION</span> $0
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgba283b6" class="outline-4">
<h4 id="orgba283b6">Index</h4>
<div class="outline-text-4" id="text-orgba283b6">
</div>
<div id="outline-container-org91421aa" class="outline-5">
<h5 id="org91421aa">[cni] Create Non-Clustered Index</h5>
<div class="outline-text-5" id="text-org91421aa">
<p>
Creates a basic, non-clustered index.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Create</span> non-<span class="org-keyword">unique</span> n...
# <span class="org-comment">--</span>
<span class="org-keyword">IF</span> <span class="org-keyword">EXISTS</span> (<span class="org-keyword">SELECT</span> <span class="org-keyword">name</span> <span class="org-keyword">FROM</span> sys.indexes <span class="org-keyword">WHERE</span> <span class="org-keyword">name</span> = N<span class="org-string">'${3:index_name}'</span>)
    <span class="org-keyword">DROP</span> <span class="org-keyword">INDEX</span> $3 <span class="org-keyword">ON</span> ${1:[<span class="org-keyword">schema</span>].[owner_name]};
<span class="org-doc">go</span>

<span class="org-keyword">CREATE</span> <span class="org-keyword">NONCLUSTERED</span> <span class="org-keyword">INDEX</span> $3
<span class="org-keyword">ON</span> $1 (${2:<span class="org-keyword">column</span>})
<span class="org-comment">--WITH PAD_INDEX</span>
<span class="org-comment">--    | FILLFACTOR = fillfactor</span>
<span class="org-comment">--    | IGNORE_DUP_KEY</span>
<span class="org-comment">--    | DROP_EXISTING</span>
<span class="org-comment">--    | STATISTICS_NORECOMPUTE</span>
<span class="org-comment">--    | SORT_IN_TEMPDB, .. as required</span>
<span class="org-comment">-- ON filegroup</span>
<span class="org-doc">go</span>
$0
</pre>
</div>
</div>
</div>

<div id="outline-container-org5b1ad3b" class="outline-5">
<h5 id="org5b1ad3b">[cuni] Create Unique Non-Clustered Index</h5>
<div class="outline-text-5" id="text-org5b1ad3b">
<p>
Creates a unique, non-clustered index.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Create</span> <span class="org-keyword">unique</span> nonclu...
# <span class="org-comment">--</span>
<span class="org-keyword">IF</span> <span class="org-keyword">EXISTS</span> (<span class="org-keyword">SELECT</span> <span class="org-keyword">name</span> <span class="org-keyword">FROM</span> sys.indexes <span class="org-keyword">WHERE</span> <span class="org-keyword">name</span> = N<span class="org-string">'${3:index_name}'</span>)
    <span class="org-keyword">DROP</span> <span class="org-keyword">INDEX</span> $3 <span class="org-keyword">ON</span> ${1:[<span class="org-keyword">schema</span>].[owner_name]};
<span class="org-doc">go</span>

<span class="org-keyword">CREATE</span> <span class="org-keyword">UNIQUE</span> <span class="org-keyword">NONCLUSTERED</span> <span class="org-keyword">INDEX</span> $3
<span class="org-keyword">ON</span> $1 (${2:<span class="org-keyword">column</span>})
<span class="org-comment">--WITH</span>
<span class="org-comment">--    PAD_INDEX,</span>
<span class="org-comment">--    FILLFACTOR = fillfactor,</span>
<span class="org-comment">--    IGNORE_DUP_KEY,</span>
<span class="org-comment">--    DROP_EXISTING = OFF,</span>
<span class="org-comment">--    STATISTICS_NORECOMPUTE,</span>
<span class="org-comment">--    SORT_IN_TEMPDB = OFF, .. as required</span>
<span class="org-keyword">ON</span> ${3:<span class="org-builtin">filegroup_name</span>}
<span class="org-doc">go</span>
$0
</pre>
</div>
</div>
</div>

<div id="outline-container-org27bac2e" class="outline-5">
<h5 id="org27bac2e">[cci] Create Clustered Index</h5>
<div class="outline-text-5" id="text-org27bac2e">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Create</span> non-<span class="org-keyword">unique</span> cl...
# <span class="org-comment">--</span>
<span class="org-keyword">IF</span> <span class="org-keyword">EXISTS</span> (<span class="org-keyword">SELECT</span> <span class="org-keyword">name</span> <span class="org-keyword">FROM</span> sys.indexes <span class="org-keyword">WHERE</span> <span class="org-keyword">name</span> = N<span class="org-string">'${3:index_name}'</span>)
    <span class="org-keyword">DROP</span> <span class="org-keyword">INDEX</span> $3 <span class="org-keyword">ON</span> ${1:[<span class="org-keyword">schema</span>].[owner_name]};
<span class="org-doc">go</span>

<span class="org-keyword">CREATE</span> <span class="org-keyword">CLUSTERED</span> <span class="org-keyword">INDEX</span> $3
<span class="org-keyword">ON</span> $1 (${2:<span class="org-keyword">column</span>})
<span class="org-comment">--WITH PAD_INDEX</span>
<span class="org-comment">--    | FILLFACTOR = fillfactor</span>
<span class="org-comment">--    | IGNORE_DUP_KEY</span>
<span class="org-comment">--    | DROP_EXISTING</span>
<span class="org-comment">--    | STATISTICS_NORECOMPUTE</span>
<span class="org-comment">--    | SORT_IN_TEMPDB, .. as required</span>
<span class="org-comment">-- ON filegroup</span>
<span class="org-doc">go</span>
$0
</pre>
</div>
</div>
</div>

<div id="outline-container-orge4c0073" class="outline-5">
<h5 id="orge4c0073">[cuci] Create Unique Clustered Index</h5>
<div class="outline-text-5" id="text-orge4c0073">
<p>
Create index full syntax.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Create</span> <span class="org-keyword">unique</span> cluster...
# <span class="org-comment">--</span>
<span class="org-keyword">IF</span> <span class="org-keyword">EXISTS</span> (<span class="org-keyword">SELECT</span> <span class="org-keyword">name</span> <span class="org-keyword">FROM</span> sys.indexes <span class="org-keyword">WHERE</span> <span class="org-keyword">name</span> = N<span class="org-string">'${3:index_name}'</span>)
    <span class="org-keyword">DROP</span> <span class="org-keyword">INDEX</span> $3 <span class="org-keyword">ON</span> ${1:[<span class="org-keyword">schema</span>].[owner_name]};
<span class="org-doc">go</span>

<span class="org-keyword">CREATE</span> <span class="org-keyword">UNIQUE</span> <span class="org-keyword">CLUSTERED</span> <span class="org-keyword">INDEX</span> $3
<span class="org-keyword">ON</span> $1 (${2:<span class="org-keyword">column</span>})
<span class="org-keyword">WITH</span>
PAD_INDEX,
<span class="org-keyword">FILLFACTOR</span> = ${3:fillfactor_value},
IGNORE_DUP_KEY,
DROP_EXISTING,
STATISTICS_NORECOMPUTE
<span class="org-comment">--    | SORT_IN_TEMPDB, .. as required</span>
<span class="org-keyword">ON</span> ${4:<span class="org-builtin">filegroup_name</span>}
<span class="org-doc">go</span>
$0
</pre>
</div>
</div>
</div>

<div id="outline-container-orga8faac8" class="outline-5">
<h5 id="orga8faac8">[di] Drop Index</h5>
<div class="outline-text-5" id="text-orga8faac8">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Drop</span> <span class="org-keyword">index</span>
# <span class="org-comment">--</span>
<span class="org-keyword">DROP</span> <span class="org-keyword">INDEX</span> $0
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0f1dd75" class="outline-4">
<h4 id="org0f1dd75">Join fragment</h4>
<div class="outline-text-4" id="text-org0f1dd75">
</div>
<div id="outline-container-org3220184" class="outline-5">
<h5 id="org3220184">[cj] Cross Join</h5>
<div class="outline-text-5" id="text-org3220184">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">CROSS</span> <span class="org-keyword">JOIN</span> fragment
# <span class="org-comment">--</span>
<span class="org-keyword">CROSS</span> <span class="org-keyword">JOIN</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-org030faf9" class="outline-5">
<h5 id="org030faf9">[fj] Full Join</h5>
<div class="outline-text-5" id="text-org030faf9">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">FULL</span> <span class="org-keyword">JOIN</span> fragment
# <span class="org-comment">--</span>
<span class="org-keyword">FULL</span> <span class="org-keyword">JOIN</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb4d1171" class="outline-5">
<h5 id="orgb4d1171">[foj] Full Outer Join</h5>
<div class="outline-text-5" id="text-orgb4d1171">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">FULL</span> <span class="org-keyword">OUTER</span> <span class="org-keyword">JOIN</span> fr...
# <span class="org-comment">--</span>
<span class="org-keyword">FULL</span> <span class="org-keyword">OUTER</span> <span class="org-keyword">JOIN</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-org65321b1" class="outline-5">
<h5 id="org65321b1">[ij] Inner Join</h5>
<div class="outline-text-5" id="text-org65321b1">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">INNER</span> <span class="org-keyword">JOIN</span> fragment
# <span class="org-comment">--</span>
<span class="org-keyword">INNER</span> <span class="org-keyword">JOIN</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-org16eece6" class="outline-5">
<h5 id="org16eece6">[j] Join</h5>
<div class="outline-text-5" id="text-org16eece6">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">JOIN</span> fragment
# <span class="org-comment">--</span>
<span class="org-keyword">JOIN</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb703c2b" class="outline-5">
<h5 id="orgb703c2b">[lj] Left Join</h5>
<div class="outline-text-5" id="text-orgb703c2b">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">LEFT</span> <span class="org-keyword">JOIN</span> fragment
# <span class="org-comment">--</span>
<span class="org-keyword">LEFT</span> <span class="org-keyword">JOIN</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-org5a59196" class="outline-5">
<h5 id="org5a59196">[loj] Left Outer Join</h5>
<div class="outline-text-5" id="text-org5a59196">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">LEFT</span> <span class="org-keyword">OUTER</span> <span class="org-keyword">JOIN</span> fr...
# <span class="org-comment">--</span>
<span class="org-keyword">LEFT</span> <span class="org-keyword">OUTER</span> <span class="org-keyword">JOIN</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-org0768134" class="outline-5">
<h5 id="org0768134">[rj] Right Join</h5>
<div class="outline-text-5" id="text-org0768134">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">RIGHT</span> <span class="org-keyword">JOIN</span> fragment
# <span class="org-comment">--</span>
<span class="org-keyword">RIGHT</span> <span class="org-keyword">JOIN</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-orgeb75fd4" class="outline-5">
<h5 id="orgeb75fd4">[roj] Right Outer Join</h5>
<div class="outline-text-5" id="text-orgeb75fd4">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">RIGHT</span> <span class="org-keyword">OUTER</span> <span class="org-keyword">JOIN</span> f...
# <span class="org-comment">--</span>
<span class="org-keyword">RIGHT</span> <span class="org-keyword">OUTER</span> <span class="org-keyword">JOIN</span> $0
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org727a865" class="outline-4">
<h4 id="org727a865">Login</h4>
<div class="outline-text-4" id="text-org727a865">
</div>
<div id="outline-container-org30306db" class="outline-5">
<h5 id="org30306db">[cl] Create SQL Authentication Login</h5>
<div class="outline-text-5" id="text-org30306db">
<p>
Creates a SQL Server Authentication login.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">CREATE</span> <span class="org-keyword">SQL</span> Server l...
# <span class="org-comment">--</span>
<span class="org-keyword">CREATE</span> LOGIN ${1:SQL_login_name}
<span class="org-keyword">WITH</span> PASSWORD = N<span class="org-string">'${2:Strong_P@ssword}'</span>$0 <span class="org-comment-delimiter">/* </span><span class="org-comment">HASHED */</span> <span class="org-comment-delimiter">/* </span><span class="org-comment">MUST_CHANGE */</span>
<span class="org-comment">--  DEFAULT_DATABASE = database</span>
<span class="org-comment">--  DEFAULT_LANGUAGE = language</span>
<span class="org-comment">--  CHECK_POLICY = ON | OFF</span>
<span class="org-comment">--  SID = sid</span>
<span class="org-comment">--  CHECK_EXPIRATION = ON | OFF</span>
<span class="org-comment">--  CREDENTIAL = credential_name</span>
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org33f5e22" class="outline-5">
<h5 id="org33f5e22">Create Windows Authentication Login</h5>
<div class="outline-text-5" id="text-org33f5e22">
<p>
Creates a Windows Authentication login.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">CREATE</span> Windows l...
# <span class="org-comment">--</span>
<span class="org-keyword">CREATE</span> LOGIN ${1:[domain_name\<span class="org-builtin">user_name</span>]}
<span class="org-keyword">FROM</span> WINDOWS$0
<span class="org-keyword">WITH</span>
DEFAULT_DATABASE = ${2:default_database}
<span class="org-comment">--  DEFAULT_LANGUAGE = language</span>
<span class="org-comment">--  CERTIFICATE certificate_name</span>
<span class="org-comment">--  ASYMMETRIC KEY key_name</span>
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgba5ab63" class="outline-5">
<h5 id="orgba5ab63">[dl] Drop Login</h5>
<div class="outline-text-5" id="text-orgba5ab63">
<p>
Drop login.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Drop</span> login
# <span class="org-comment">--</span>
<span class="org-keyword">DROP</span> LOGIN ${1:SQL_login_name}
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc1aad51" class="outline-4">
<h4 id="orgc1aad51">Role</h4>
<div class="outline-text-4" id="text-orgc1aad51">
</div>
<div id="outline-container-orgcb3ace3" class="outline-5">
<h5 id="orgcb3ace3">Create Role</h5>
<div class="outline-text-5" id="text-orgcb3ace3">
<p>
Create Database Role.
</p>

<div class="org-src-container">
<pre class="src src-sql"><span class="org-doc">USE ${1:database_name}</span>
<span class="org-doc">go</span>

<span class="org-keyword">CREATE</span> <span class="org-keyword">ROLE</span> ${2:role_name}$0
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org3497545" class="outline-4">
<h4 id="org3497545">Schema</h4>
<div class="outline-text-4" id="text-org3497545">
</div>
<div id="outline-container-org4a7e297" class="outline-5">
<h5 id="org4a7e297">Create Schema</h5>
<div class="outline-text-5" id="text-org4a7e297">
<p>
Create a database schema.
</p>

<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">CREATE</span> <span class="org-keyword">SCHEMA</span> ${1:<span class="org-keyword">schema</span>}$0
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc9ec7e3" class="outline-4">
<h4 id="orgc9ec7e3">Set options</h4>
<div class="outline-text-4" id="text-orgc9ec7e3">
</div>
<div id="outline-container-org49fc577" class="outline-5">
<h5 id="org49fc577">[san] Set ANSI_NULLS</h5>
<div class="outline-text-5" id="text-org49fc577">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: Change the <span class="org-keyword">current</span> A...
# <span class="org-comment">--</span>
<span class="org-doc">SET ANSI_NULLS ON$0</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org04e72f3" class="outline-5">
<h5 id="org04e72f3">[sqi] Set QUOTED_IDENTIFIER</h5>
<div class="outline-text-5" id="text-org04e72f3">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: Change the <span class="org-keyword">current</span> ...
# <span class="org-comment">--</span>
<span class="org-doc">SET QUOTED_IDENTIFIER ON$0</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9af0080" class="outline-5">
<h5 id="org9af0080">[sxa] Set XACT_ABORT</h5>
<div class="outline-text-5" id="text-org9af0080">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: Change the <span class="org-keyword">current</span> X...
# <span class="org-comment">--</span>
<span class="org-doc">SET XACT_ABORT OFF$0</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org2ca40fb" class="outline-4">
<h4 id="org2ca40fb">Stored Procedure</h4>
<div class="outline-text-4" id="text-org2ca40fb">
<p>
Naming convention: stored procedures are prefixed with <code>usp</code>.
</p>
</div>

<div id="outline-container-org907715d" class="outline-5">
<h5 id="org907715d">[cp] Create Procedure Basic Template</h5>
<div class="outline-text-5" id="text-org907715d">
<p>
Create a simple stored procedure with output parameter.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Create</span> stored proced...
# <span class="org-comment">--</span>
<span class="org-comment">-- Drop stored procedure if it already exists</span>
<span class="org-keyword">IF</span> <span class="org-builtin">OBJECT_ID</span> (<span class="org-string">'${1:[schema].[procedure_name]}'</span>, <span class="org-string">'P'</span>) <span class="org-keyword">IS</span> <span class="org-keyword">NOT</span> <span class="org-keyword">NULL</span>
    <span class="org-keyword">DROP</span> <span class="org-keyword">PROCEDURE</span> $1;
<span class="org-doc">go</span>

<span class="org-comment">-- =============================================</span>
<span class="org-doc">SET ANSI_NULLS ON</span>
<span class="org-doc">go</span>
<span class="org-doc">SET QUOTED_IDENTIFIER ON</span>
<span class="org-doc">go</span>
<span class="org-comment">-- =============================================</span>
<span class="org-comment">-- Author:      /* Author */</span>
<span class="org-comment">-- Create date: /* Create Date */</span>
<span class="org-comment">-- Description: /* Description */</span>
<span class="org-comment">-- =============================================</span>
<span class="org-keyword">CREATE</span> <span class="org-keyword">PROCEDURE</span> $1
    <span class="org-comment">-- Add the parameters for the function here</span>
    <span class="org-variable-name">@</span>${2:parameter_name_1} ${3:parameter_data_type_1} = ${4:default_value_for_parameter_1}
    <span class="org-variable-name">@</span>${5:parameter_name_2} ${6:parameter_data_type_2} <span class="org-keyword">OUTPUT</span>
<span class="org-comment">-- WITH ENCRYPTION, RECOMPILE, EXECUTE AS CALLER|SELF|OWNER| 'user_name'</span>
<span class="org-keyword">AS</span>
<span class="org-keyword">BEGIN</span>
    <span class="org-comment">-- SET NOCOUNT ON added to prevent extra result sets from</span>
    <span class="org-comment">-- interfering with SELECT statements.</span>
    <span class="org-keyword">SET</span> NOCOUNT <span class="org-keyword">ON</span>;

    <span class="org-comment">-- Insert statements for procedure here</span>
    <span class="org-keyword">SELECT</span> <span class="org-variable-name">@</span>$2$0
<span class="org-keyword">END</span>
<span class="org-doc">go</span>

<span class="org-comment">--SET QUOTED_IDENTIFIER ON|OFF</span>
<span class="org-comment">--SET ANSI_NULLS ON|OFF</span>
<span class="org-comment">--go</span>

<span class="org-comment">-- =============================================</span>
<span class="org-comment">-- Example to execute the stored procedure</span>
<span class="org-comment">-- =============================================</span>
<span class="org-keyword">DECLARE</span> <span class="org-variable-name">@</span>${7:variable_for_output_parameter} $6

<span class="org-keyword">EXECUTE</span> $1 <span class="org-comment-delimiter">/* </span><span class="org-comment">value_for_parameter_1 */</span>, $7 <span class="org-keyword">OUTPUT</span>

<span class="org-keyword">SELECT</span> $7
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6248b24" class="outline-5">
<h5 id="org6248b24">[crlp] Create CLR Procedure</h5>
<div class="outline-text-5" id="text-org6248b24">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Create</span> CLR stored pr...
# <span class="org-comment">--</span>
<span class="org-comment">--SET QUOTED_IDENTIFIER ON|OFF</span>
<span class="org-comment">--SET ANSI_NULLS ON|OFF</span>
<span class="org-comment">--go</span>

<span class="org-keyword">CREATE</span> <span class="org-keyword">PROCEDURE</span> ${1:[<span class="org-keyword">schema</span>].[procedure_name]}
(
    <span class="org-variable-name">@</span>${2:<span class="org-keyword">parameter_name</span>} ${3:parameter_data_type}
)
<span class="org-comment">-- WITH EXECUTE AS CALLER|SELF|OWNER| 'user_name'</span>
<span class="org-keyword">AS</span> <span class="org-keyword">EXTERNAL</span> <span class="org-keyword">NAME</span> ${4:[assembly].[<span class="org-keyword">class</span>].[<span class="org-keyword">method</span>]};
<span class="org-doc">go</span>

<span class="org-comment">--SET QUOTED_IDENTIFIER ON|OFF</span>
<span class="org-comment">--SET ANSI_NULLS ON|OFF</span>
<span class="org-comment">--go$0</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1fb9c4f" class="outline-5">
<h5 id="org1fb9c4f">[ap] Alter Procedure</h5>
<div class="outline-text-5" id="text-org1fb9c4f">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">ALTER</span> <span class="org-keyword">PROCEDURE</span>
# <span class="org-comment">--</span>
<span class="org-keyword">ALTER</span> <span class="org-keyword">PROCEDURE</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc3d058d" class="outline-5">
<h5 id="orgc3d058d">[dp] Drop Procedure</h5>
<div class="outline-text-5" id="text-orgc3d058d">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Drop</span> stored <span class="org-keyword">procedure</span>
# <span class="org-comment">--</span>
<span class="org-keyword">DROP</span> <span class="org-keyword">PROCEDURE</span> $0
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org32ee07a" class="outline-4">
<h4 id="org32ee07a">Synonym</h4>
<div class="outline-text-4" id="text-org32ee07a">
</div>
<div id="outline-container-orgae716ab" class="outline-5">
<h5 id="orgae716ab">Create Synonym</h5>
<div class="outline-text-5" id="text-orgae716ab">
<p>
Creates a synonym.
</p>

<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">CREATE</span> SYNONYM ${1:[<span class="org-keyword">schema</span>].[synonym_name]}
<span class="org-keyword">FOR</span> ${2:[<span class="org-keyword">schema</span>].[<span class="org-builtin">object_name</span>]};
<span class="org-doc">go$0</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgfb9a378" class="outline-4">
<h4 id="orgfb9a378">Table</h4>
<div class="outline-text-4" id="text-orgfb9a378">
</div>
<div id="outline-container-org345f982" class="outline-5">
<h5 id="org345f982">[ct] Create Table</h5>
<div class="outline-text-5" id="text-org345f982">
<p>
Creates a table (and drop previous one with the same name).
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Create</span> <span class="org-keyword">table</span>
# <span class="org-comment">--</span>
<span class="org-keyword">IF</span> <span class="org-builtin">OBJECT_ID</span> (<span class="org-string">'${1:[schema].[table_name]}'</span>, <span class="org-string">'U'</span>) <span class="org-keyword">IS</span> <span class="org-keyword">NOT</span> <span class="org-keyword">NULL</span>
    <span class="org-keyword">DROP</span> <span class="org-keyword">TABLE</span> $1;
<span class="org-doc">go</span>

<span class="org-keyword">CREATE</span> <span class="org-keyword">TABLE</span> $1
(
    ${2:column_1} ${3:data_type_1} ${4:column_nullability_1},
    ${5:column_2} ${6:data_type_2} ${5:column_nullability_2},$0
    <span class="org-keyword">CONSTRAINT</span> <span class="org-comment-delimiter">/* </span><span class="org-comment">contraint_name */</span> <span class="org-keyword">PRIMARY</span> <span class="org-keyword">KEY</span> (<span class="org-comment-delimiter">/* </span><span class="org-comment">columns_in_primary_key */</span>)
);
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcc5c759" class="outline-5">
<h5 id="orgcc5c759">[at] Alter Table fragment</h5>
<div class="outline-text-5" id="text-orgcc5c759">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">ALTER</span> <span class="org-keyword">TABLE</span> fragm...
# <span class="org-comment">--</span>
<span class="org-keyword">ALTER</span> <span class="org-keyword">TABLE</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd693b95" class="outline-5">
<h5 id="orgd693b95">[ata] Add Column</h5>
<div class="outline-text-5" id="text-orgd693b95">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Add</span> <span class="org-keyword">column</span>
# <span class="org-comment">--</span>
<span class="org-keyword">ALTER</span> <span class="org-keyword">TABLE</span> ${1:[<span class="org-keyword">schema</span>].[<span class="org-keyword">table_name</span>]} <span class="org-keyword">ADD</span> [${2:<span class="org-keyword">column_name</span>}] ${3:data_type} ${4:column_nullability};
<span class="org-doc">go$0</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9bfabb5" class="outline-5">
<h5 id="org9bfabb5">[atac] modify Column</h5>
<div class="outline-text-5" id="text-org9bfabb5">
<div class="warning">
<p>
Running <code>ALTER COLUMN</code> without mentioning attribute <code>NOT NULL</code> will result in the
column being changed to <b>nullable</b>, if it is already not.
</p>

</div>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Modify</span> <span class="org-keyword">column</span>
# <span class="org-comment">--</span>
<span class="org-comment">-- WARNING: If the column is not nullable, specify attribute NOT NULL.</span>
<span class="org-keyword">ALTER</span> <span class="org-keyword">TABLE</span> ${1:[<span class="org-keyword">schema</span>].[<span class="org-keyword">table_name</span>]} <span class="org-keyword">ALTER</span> <span class="org-keyword">COLUMN</span> $0;
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7689f5a" class="outline-5">
<h5 id="org7689f5a">[atd] Drop column</h5>
<div class="outline-text-5" id="text-org7689f5a">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Drop</span> <span class="org-keyword">column</span>
# <span class="org-comment">--</span>
<span class="org-keyword">ALTER</span> <span class="org-keyword">TABLE</span> ${1:[<span class="org-keyword">schema</span>].[<span class="org-keyword">table_name</span>]} <span class="org-keyword">DROP</span> <span class="org-keyword">COLUMN</span> $0;
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaaa7065" class="outline-5">
<h5 id="orgaaa7065">Add Constraint</h5>
<div class="outline-text-5" id="text-orgaaa7065">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Add</span> <span class="org-keyword">constraint</span>
# <span class="org-comment">--</span>
<span class="org-keyword">ALTER</span> <span class="org-keyword">TABLE</span> ${1:[<span class="org-keyword">schema</span>].[<span class="org-keyword">table_name</span>]}
<span class="org-keyword">ADD</span> <span class="org-keyword">CONSTRAINT</span> ${2:<span class="org-keyword">constraint_name</span>};
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1eecdd0" class="outline-5">
<h5 id="org1eecdd0">[atdc] Drop Constraint</h5>
<div class="outline-text-5" id="text-org1eecdd0">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Drop</span> <span class="org-keyword">constraint</span>
# <span class="org-comment">--</span>
<span class="org-keyword">ALTER</span> <span class="org-keyword">TABLE</span> ${1:[<span class="org-keyword">schema</span>].[<span class="org-keyword">table_name</span>]}
<span class="org-keyword">DROP</span> <span class="org-keyword">CONSTRAINT</span> ${2:<span class="org-keyword">constraint_name</span>};
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge3d7a80" class="outline-5">
<h5 id="orge3d7a80">[dt] Drop Table</h5>
<div class="outline-text-5" id="text-orge3d7a80">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Drop</span> <span class="org-keyword">table</span>
# <span class="org-comment">--</span>

<span class="org-keyword">IF</span> <span class="org-keyword">EXISTS</span> (<span class="org-keyword">SELECT</span> *
             <span class="org-keyword">FROM</span> sys.tables
             <span class="org-keyword">JOIN</span> sys.schemas
               <span class="org-keyword">ON</span> sys.tables.schema_id = sys.schemas.schema_id
            <span class="org-keyword">WHERE</span> sys.schemas.<span class="org-keyword">name</span> = N<span class="org-string">'${1:schema}'</span>
              <span class="org-keyword">AND</span> sys.tables.<span class="org-keyword">name</span> = N<span class="org-string">'${2:table}'</span>)
    <span class="org-keyword">DROP</span> <span class="org-keyword">TABLE</span> $1.$2
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org478fbb9" class="outline-4">
<h4 id="org478fbb9">Transaction</h4>
<div class="outline-text-4" id="text-org478fbb9">
</div>
<div id="outline-container-org951c218" class="outline-5">
<h5 id="org951c218">[bt] Begin Transaction</h5>
<div class="outline-text-5" id="text-org951c218">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Begin</span> <span class="org-keyword">transaction</span>
# <span class="org-comment">--</span>
<span class="org-keyword">BEGIN</span> <span class="org-keyword">TRANSACTION</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc13060a" class="outline-5">
<h5 id="orgc13060a">[ctr] Commit Transaction</h5>
<div class="outline-text-5" id="text-orgc13060a">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Commit</span> <span class="org-keyword">transaction</span>
# <span class="org-comment">--</span>
<span class="org-keyword">COMMIT</span> <span class="org-keyword">TRANSACTION</span> $0
</pre>
</div>
</div>
</div>

<div id="outline-container-org8d0ac2c" class="outline-5">
<h5 id="org8d0ac2c">[rt] Rollback Transaction</h5>
<div class="outline-text-5" id="text-org8d0ac2c">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Rollback</span> <span class="org-keyword">transaction</span>
# <span class="org-comment">--</span>
<span class="org-keyword">ROLLBACK</span> <span class="org-keyword">TRANSACTION</span> $0
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org20f4fcb" class="outline-4">
<h4 id="org20f4fcb">Trigger</h4>
<div class="outline-text-4" id="text-org20f4fcb">
</div>
<div id="outline-container-org21b30ba" class="outline-5">
<h5 id="org21b30ba">Create Trigger</h5>
<div class="outline-text-5" id="text-org21b30ba">
<p>
Creates a trigger.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Create</span> <span class="org-keyword">trigger</span>
# <span class="org-comment">--</span>
<span class="org-keyword">IF</span> <span class="org-builtin">OBJECT_ID</span> (<span class="org-string">'${1:trigger_name}'</span>, <span class="org-string">'TR'</span>) <span class="org-keyword">IS</span> <span class="org-keyword">NOT</span> <span class="org-keyword">NULL</span>
    <span class="org-keyword">DROP</span> <span class="org-keyword">TRIGGER</span> $1;
<span class="org-doc">go</span>

<span class="org-comment">-- =============================================</span>
<span class="org-doc">SET ANSI_NULLS ON</span>
<span class="org-doc">go</span>
<span class="org-doc">SET QUOTED_IDENTIFIER ON</span>
<span class="org-doc">go</span>
<span class="org-comment">-- =============================================</span>
<span class="org-comment">-- Author:      /* Author */</span>
<span class="org-comment">-- Create date: /* Create Date */</span>
<span class="org-comment">-- Description: /* Description */</span>
<span class="org-comment">-- =============================================</span>
<span class="org-keyword">CREATE</span> <span class="org-keyword">TRIGGER</span> $1
<span class="org-keyword">ON</span> ${2:[<span class="org-keyword">schema</span>].[<span class="org-keyword">table_name</span>]}
<span class="org-keyword">FOR</span> <span class="org-keyword">INSERT</span>, <span class="org-keyword">UPDATE</span>, <span class="org-keyword">DELETE</span>
<span class="org-keyword">AS</span>
<span class="org-keyword">BEGIN</span>
    <span class="org-comment">-- SET NOCOUNT ON added to prevent extra result sets from</span>
    <span class="org-comment">-- interfering with SELECT statements.</span>
    <span class="org-keyword">SET</span> NOCOUNT <span class="org-keyword">ON</span>;

    <span class="org-comment">-- Insert statements for trigger here</span>
    <span class="org-keyword">RAISERROR</span> (50009, 16, 10)
    $0
<span class="org-keyword">END</span>;
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8cf0090" class="outline-5">
<h5 id="org8cf0090">Enable Trigger</h5>
<div class="outline-text-5" id="text-org8cf0090">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: Enable <span class="org-keyword">trigger</span>
# <span class="org-comment">--</span>
<span class="org-keyword">ALTER</span> <span class="org-keyword">TABLE</span> ${1:[<span class="org-keyword">schema</span>].[<span class="org-keyword">table_name</span>]} ENABLE <span class="org-keyword">TRIGGER</span> $0;
</pre>
</div>
</div>
</div>

<div id="outline-container-org1132258" class="outline-5">
<h5 id="org1132258">Enable All Triggers</h5>
<div class="outline-text-5" id="text-org1132258">
<p>
Enable all triggers on table.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: Enable <span class="org-keyword">all</span> triggers <span class="org-keyword">on</span>...
# <span class="org-comment">--</span>
<span class="org-keyword">ALTER</span> <span class="org-keyword">TABLE</span> ${1:[<span class="org-keyword">schema</span>].[<span class="org-keyword">table_name</span>]}$0 ENABLE <span class="org-keyword">TRIGGER</span> <span class="org-keyword">ALL</span>;
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org88dacdb" class="outline-5">
<h5 id="org88dacdb">Disable Trigger</h5>
<div class="outline-text-5" id="text-org88dacdb">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: Disable <span class="org-keyword">trigger</span>
# <span class="org-comment">--</span>
<span class="org-keyword">ALTER</span> <span class="org-keyword">TABLE</span> ${1:[<span class="org-keyword">schema</span>].[<span class="org-keyword">table_name</span>]} DISABLE <span class="org-keyword">TRIGGER</span> $0;
</pre>
</div>
</div>
</div>

<div id="outline-container-org276fc44" class="outline-5">
<h5 id="org276fc44">Disable All Triggers</h5>
<div class="outline-text-5" id="text-org276fc44">
<p>
Disable all triggers on table.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: Disable <span class="org-keyword">all</span> triggers <span class="org-keyword">on</span>...
# <span class="org-comment">--</span>
<span class="org-keyword">ALTER</span> <span class="org-keyword">TABLE</span> ${1:[<span class="org-keyword">schema</span>].[<span class="org-keyword">table_name</span>]}$0 DISABLE <span class="org-keyword">TRIGGER</span> <span class="org-keyword">ALL</span>;
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org82ddbd9" class="outline-4">
<h4 id="org82ddbd9">User</h4>
<div class="outline-text-4" id="text-org82ddbd9">
</div>
<div id="outline-container-org1b7bc6b" class="outline-5">
<h5 id="org1b7bc6b">[cu] Create User</h5>
<div class="outline-text-5" id="text-org1b7bc6b">
<p>
Creates a database user.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Create</span> <span class="org-keyword">database</span> <span class="org-keyword">user</span>
# <span class="org-comment">--</span>
<span class="org-keyword">CREATE</span> <span class="org-keyword">USER</span> ${1:UserName}$0
<span class="org-keyword">FOR</span> <span class="org-comment-delimiter">/* </span><span class="org-comment">FROM */</span> LOGIN <span class="org-comment-delimiter">/* </span><span class="org-comment">login_name */</span>
<span class="org-comment">--  CERTIFICATE certificate_name</span>
<span class="org-comment">--  ASYMMETRIC KEY key_name</span>
<span class="org-comment">--  WITHOUT LOGIN</span>
<span class="org-comment">--  WITH DEFAULT_SCHEMA = schema_name</span>
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd87409e" class="outline-5">
<h5 id="orgd87409e">[du] Drop User</h5>
<div class="outline-text-5" id="text-orgd87409e">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Drop</span> <span class="org-keyword">user</span>
# <span class="org-comment">--</span>
<span class="org-keyword">DROP</span> <span class="org-keyword">USER</span> ${1:<span class="org-builtin">user_name</span>}
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org057b111" class="outline-4">
<h4 id="org057b111">User Defined Data Type</h4>
<div class="outline-text-4" id="text-org057b111">
</div>
<div id="outline-container-orgb40741d" class="outline-5">
<h5 id="orgb40741d">Create User-Defined Data Type</h5>
<div class="outline-text-5" id="text-orgb40741d">
<p>
Creates a user-defined data type.
</p>

<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">CREATE</span> <span class="org-keyword">TYPE</span> ${1:[<span class="org-keyword">schema</span>].[my_data_type]}
<span class="org-keyword">FROM</span> ${2:data_type} ${3:column_nullability}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org5520b48" class="outline-4">
<h4 id="org5520b48">User Defined Table Type</h4>
<div class="outline-text-4" id="text-org5520b48">
</div>
<div id="outline-container-org6b48fc3" class="outline-5">
<h5 id="org6b48fc3">Create User-Defined Table Type</h5>
<div class="outline-text-5" id="text-org6b48fc3">
<p>
Creates a user-defined table type.
</p>

<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">CREATE</span> <span class="org-keyword">TYPE</span> ${1:[<span class="org-keyword">schema</span>].[my_table_type]} <span class="org-keyword">AS</span> <span class="org-keyword">TABLE</span>
(
    ${2:column_1} ${3:data_type_1},
    ${4:column_2} ${5:data_type_2}
);
<span class="org-doc">go$0</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org3091b07" class="outline-4">
<h4 id="org3091b07">User Defined Type</h4>
<div class="outline-text-4" id="text-org3091b07">
</div>
<div id="outline-container-orgc14906f" class="outline-5">
<h5 id="orgc14906f">Create User-Defined Type</h5>
<div class="outline-text-5" id="text-orgc14906f">
<p>
Creates a CLR integration user-defined type.
</p>

<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">CREATE</span> <span class="org-keyword">TYPE</span> ${1:Utf8String}
<span class="org-keyword">EXTERNAL</span> <span class="org-keyword">NAME</span> ${2:utf8string}.${3:[Microsoft.Samples.SqlServer.utf8string]};
<span class="org-doc">go$0</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org8157604" class="outline-4">
<h4 id="org8157604">View</h4>
<div class="outline-text-4" id="text-org8157604">
</div>
<div id="outline-container-orgf88511d" class="outline-5">
<h5 id="orgf88511d">[cv] Create View</h5>
<div class="outline-text-5" id="text-orgf88511d">
<p>
Creates a view.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Create</span> <span class="org-keyword">view</span>
# <span class="org-comment">--</span>
<span class="org-keyword">IF</span> <span class="org-builtin">OBJECT_ID</span> (<span class="org-string">'${1:[schema].[view_name]}'</span>, <span class="org-string">'V'</span>) <span class="org-keyword">IS</span> <span class="org-keyword">NOT</span> <span class="org-keyword">NULL</span>
    <span class="org-keyword">DROP</span> <span class="org-keyword">VIEW</span> $1;
<span class="org-doc">go</span>

<span class="org-keyword">CREATE</span> <span class="org-keyword">VIEW</span> $1
<span class="org-comment">--WITH ENCRYPTION, SCHEMABINDING, VIEW_METADATA</span>
<span class="org-keyword">AS</span>
    <span class="org-keyword">SELECT</span> *
    <span class="org-keyword">FROM</span> ${2:[<span class="org-keyword">schema</span>].[sample_table]}
    $0
<span class="org-comment">-- WITH CHECK OPTION</span>
<span class="org-doc">go</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2070757" class="outline-5">
<h5 id="org2070757">[dv] Drop View</h5>
<div class="outline-text-5" id="text-org2070757">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Drop</span> <span class="org-keyword">view</span>
# <span class="org-comment">--</span>
<span class="org-keyword">DROP</span> <span class="org-keyword">VIEW</span> $0
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org2426d0b" class="outline-4">
<h4 id="org2426d0b">&#x2014; Miscellaneous ---</h4>
<div class="outline-text-4" id="text-org2426d0b">
</div>
<div id="outline-container-org65da9be" class="outline-5">
<h5 id="org65da9be">[sph] sp_help</h5>
<div class="outline-text-5" id="text-org65da9be">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Execute</span> sp_help
# <span class="org-comment">--</span>
<span class="org-keyword">EXEC</span> sp_help$0
</pre>
</div>
</div>
</div>

<div id="outline-container-org7a984b9" class="outline-5">
<h5 id="org7a984b9">[spt] sp_helptext</h5>
<div class="outline-text-5" id="text-org7a984b9">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Execute</span> sp_helptext
# <span class="org-comment">--</span>
<span class="org-keyword">EXEC</span> sp_helptext$0
</pre>
</div>
</div>
</div>

<div id="outline-container-org253dc2b" class="outline-5">
<h5 id="org253dc2b">[xpfd] xp_fixeddrives</h5>
<div class="outline-text-5" id="text-org253dc2b">
<p>
Retrieve free space on all fixed drives.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: Retrieve <span class="org-keyword">free</span> <span class="org-builtin">space</span> o...
# <span class="org-comment">--</span>
<span class="org-keyword">EXEC</span> master..xp_fixeddrives
</pre>
</div>
</div>
</div>

<div id="outline-container-org04899ea" class="outline-5">
<h5 id="org04899ea">[w2] Who2</h5>
<div class="outline-text-5" id="text-org04899ea">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-keyword">Execute</span> sp_who2$0
# <span class="org-comment">--</span>
<span class="org-keyword">EXEC</span> sp_who2$0
</pre>
</div>
</div>
</div>

<div id="outline-container-org65fb871" class="outline-5">
<h5 id="org65fb871">[err] @@ERROR</h5>
<div class="outline-text-5" id="text-org65fb871">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: <span class="org-builtin">@@ERROR</span> <span class="org-keyword">function</span> ...
# <span class="org-comment">--</span>
<span class="org-builtin">@@ERROR</span>$0
</pre>
</div>
</div>
</div>

<div id="outline-container-orga482c39" class="outline-5">
<h5 id="orga482c39">[mro] Most Recent Objects</h5>
<div class="outline-text-5" id="text-orga482c39">
<p>
Retrieve 20 most recently created objects.
</p>

<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: Retrieve 20 most rec...
# <span class="org-comment">--</span>
<span class="org-keyword">SELECT</span> <span class="org-keyword">TOP</span> 20 [<span class="org-keyword">name</span>], [<span class="org-keyword">type</span>], crdate
<span class="org-keyword">FROM</span> sysobjects
<span class="org-keyword">ORDER</span> <span class="org-keyword">BY</span> crdate <span class="org-keyword">DESC</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbebaea7" class="outline-5">
<h5 id="orgbebaea7">Comment</h5>
<div class="outline-text-5" id="text-orgbebaea7">
<p>
A comment block.
</p>

<div class="org-src-container">
<pre class="src src-sql"><span class="org-comment-delimiter">/*</span>
<span class="org-comment"> * $0</span>
<span class="org-comment"> */</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org039ea83" class="outline-5">
<h5 id="org039ea83">Comment</h5>
<div class="outline-text-5" id="text-org039ea83">
<p>
A multiline comment block.
</p>

<div class="org-src-container">
<pre class="src src-sql"><span class="org-comment-delimiter">/*******************************************</span>
<span class="org-comment"> * $0</span>
<span class="org-comment"> *******************************************/</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org17644af" class="outline-3">
<h3 id="org17644af">Surround With&#x2026;</h3>
<div class="outline-text-3" id="text-org17644af">
</div>
<div id="outline-container-orgb3fe218" class="outline-4">
<h4 id="orgb3fe218">[begin] Code Snippet for BEGIN&#x2026;END block</h4>
<div class="outline-text-4" id="text-orgb3fe218">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: Surround <span class="org-keyword">with</span> <span class="org-keyword">BEGIN</span>...
# <span class="org-comment">--</span>
<span class="org-keyword">BEGIN</span>
`yas-selected-<span class="org-type">text</span>`
<span class="org-keyword">END</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0b245ec" class="outline-4">
<h4 id="org0b245ec">[if] Code Snippet for IF construct</h4>
<div class="outline-text-4" id="text-org0b245ec">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: Surround <span class="org-keyword">with</span> <span class="org-keyword">IF</span>...
# <span class="org-comment">--</span>
<span class="org-keyword">IF</span> (${1:Condition})
<span class="org-keyword">BEGIN</span>

`yas-selected-<span class="org-type">text</span>`

<span class="org-keyword">END</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge142783" class="outline-4">
<h4 id="orge142783">[while] Code Snippet for WHILE loop</h4>
<div class="outline-text-4" id="text-orge142783">
<div class="org-src-container">
<pre class="src src-sql"># <span class="org-keyword">name</span>: Surround <span class="org-keyword">with</span> <span class="org-keyword">WHILE</span>...
# <span class="org-comment">--</span>
<span class="org-keyword">WHILE</span> (${1:Condition})
<span class="org-keyword">BEGIN</span>

`yas-selected-<span class="org-type">text</span>`

<span class="org-keyword">END</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Fabrice Niessen</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
